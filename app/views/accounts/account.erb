<%= partial :'accounts/cover' %>

<div class="row">

  <div class="col-sm-4 cover-sidebar">

    <%= partial :'accounts/sidebar' %>

  </div>
  <div class="col-sm-8 pt-3">

    <% if @account.story %>
      <h2><%=@account.firstname%>'s story</h2>
      <p>
        <%= Rinku.auto_link(@account.story.gsub("\n",'<br />')) %>
      </p>   
    <% end %>  
      
    <h2>Endorsed by <span class="badge badge-primary"><%= @account.endorsements_as_endorsee.count%></span></h2>

    <div class="image-wall">
      <% @account.endorsed_by.order('endorsement_count desc').each { |account| endorsement = @account.endorsements_as_endorsee.find_by(endorser: account) %>

        <% if endorsement.body %>
          <%= partial :'accounts/square', :locals => {:account => account, :content => endorsement.body, :style => "width: 64px; border: 2px solid rgb(34,141,255)"} %>
        <% else %>
          <%= partial :'accounts/square', :locals => {:account => account, :width => '64px'} %>
        <% end %>
      <% } %>   
    </div>

    <h2 class="mt-3">Endorses <span class="badge badge-primary"><%= @account.endorsements_as_endorser.count%></span></h2>

    <div class="image-wall">
      <% @account.endorses.order('endorsement_count desc').each { |account| endorsement = @account.endorsements_as_endorser.find_by(endorsee: account) %>

        <% if endorsement.body %>
          <%= partial :'accounts/square', :locals => {:account => account, :content => endorsement.body, :style => "width: 64px; border: 2px solid rgb(34,141,255)"} %>
        <% else %>
          <%= partial :'accounts/square', :locals => {:account => account, :width => '64px'} %>
        <% end %>     

      <% } %>   
    </div>      

    <% if @shared_conversations and !@shared_conversations.empty? %>
      <h3>Recent conversations</h3>
      <%= partial :'conversations/conversations_table', :locals => {:conversations => @shared_conversations}%>
    <% end %>    

  </div>
</div>
